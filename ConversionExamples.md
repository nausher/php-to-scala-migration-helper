Here's the first example: test\_2.php was the input script, test\_2.scala is the converted output. The converted script runs 3.4x faster than the original PHP. The converted script is shown without modification except for indentation provided by IntelliJ IDEA 9.0.1. Please note that to compile and run the Scala code, you need php-scala.jar and resin.jar, both of which are included in the download. The jars provide the PHP runtime library (over 1,000 builtin functions). This example is included in the release tarball.

= Example 1: Roman Number conversion

## test\_2.php ##
```
<?php
// adapted from http://www.php.happycodings.com/Algorithms/code33.html

// Function that calculates the roman string to the given number:

function dec2roman($f)
{
	// Return false if either $f is not a real number, $f is bigger than 3999 or $f is lower or equal to 0:
	if(!is_numeric($f) || $f > 3999 || $f <= 0) return false;

	// Define the roman figures:
	$roman = array('M' => 1000, 'D' => 500, 'C' => 100, 'L' => 50, 'X' => 10, 'V' => 5, 'I' => 1);

	$amount = array();

	// Calculate the needed roman figures:
	foreach($roman as $k => $v) if(($amount[$k] = floor($f / $v)) > 0) $f -= $amount[$k] * $v;

	// Build the string:
	$retval = '';
	foreach($amount as $k => $v)
	{
		$retval .= $v <= 3 ? str_repeat($k, $v) : $k . $old_k;
		$old_k = $k;
	}

	// Replace some spacial cases and return the string:
	return str_replace(array('VIV','LXL','DCD'), array('IX','XC','CM'), $retval);
}

// Function to get the decimal value of a roman string:
function roman2dec($str = '')
{
	// Return false if not at least one letter is in the string:
	if(is_numeric($str)) return false;

	// Define the roman figures:
	$roman = array('M' => 1000, 'D' => 500, 'C' => 100, 'L' => 50, 'X' => 10, 'V' => 5, 'I' => 1);

	// Convert the string to an array of roman values:
	for($i = 0; $i < strlen($str); $i++) if(isset($roman[strtoupper($str[$i])])) $values[] = $roman[strtoupper($str[$i])];

	// Calculate the sum of that array:
	$sum = 0;
	while($curr = current($values))
	{
		$next = next($values);
		$next > $curr ? $sum += $next - $curr + 0 * next($values) : $sum += $curr;
	}

	// Return the value:
	return $sum;
}

if(count($argv) > 2) {
    $ni = $argv[1];
    $nj = $argv[2];
    $dump = '';
    for($i=0; $i< $ni; ++$i) {
      for($j=0; $j< $nj; ++$j) {
        $dump .= dec2roman($j+0);
      }
    }
    print("Total bytes: " . strlen($dump));
}
else if(is_numeric($argv[1])) {
    print(dec2roman($argv[1]));
}
else {
    print(roman2dec($argv[1]));
}

?>
```

## test\_2.scala ##
```
// generated by ../php-to-scala/php-to-scala.php on 2010-04-27T19:49:39-05:00

import php._;
import scala.Predef.{any2ArrowAssoc => _}

object test_2_php extends php.script {
  override def include {
    var ni: ref = undef;
    var nj: ref = undef;
    var dump: ref = undef;
    var i: integer = 0;
    var j: integer = 0; // adapted from http://www.php.happycodings.com/Algorithms/code33.html

    // Function that calculates the roman string to the given number:

    def dec2roman(f: ref)
    : ref = {
      var roman: ref = undef;
      var amount: ref = undef;
      var retval: ref = undef;
      var old_k: ref = undef;

      // Return false if either $f is not a real number, $f is bigger than 3999 or $f is lower or equal to 0:
      if (!is_numeric(f) || f > 3999 || f <= 0) return false;

      // Define the roman figures:
      roman = array.map("M" -> 1000, "D" -> 500, "C" -> 100, "L" -> 50, "X" -> 10, "V" -> 5, "I" -> 1);

      amount = array.list();

      // Calculate the needed roman figures:
      roman.foreach {(k: ref, v: ref) => if ((amount(k) = floor(f / v)) > 0) f -= amount(k) * v}

      // Build the string:
      retval = "";
      amount.foreach {
        (k: ref, v: ref) => {
          retval +=& (v <= 3 |? {if (_) str_repeat(k, v) else k +& old_k});
          old_k = k;
        }
      }

      // Replace some spacial cases and return the string:
      return str_replace(array.list("VIV", "LXL", "DCD"), array.list("IX", "XC", "CM"), retval);
    }

    // Function to get the decimal value of a roman string:
    def roman2dec(str: ref = "")
    : ref = {
      var roman: ref = undef;
      var i: integer = 0;
      var str: ref = undef;
      var values: ref = undef;
      var sum: integer = 0;
      var curr: ref = undef;
      var next: ref = undef;

      // Return false if not at least one letter is in the string:
      if (is_numeric(str)) return false;

      // Define the roman figures:
      roman = array.map("M" -> 1000, "D" -> 500, "C" -> 100, "L" -> 50, "X" -> 10, "V" -> 5, "I" -> 1);

      // Convert the string to an array of roman values:

      i = 0;
      while (i < strlen(str)) {
        {if (isset(roman(strtoupper(str(i))))) values += roman(strtoupper(str(i)))};
        i ++
      };

      // Calculate the sum of that array:
      sum = 0;
      while ({curr = current(values); curr})
        {
          next = next(values);
          next > curr |? {if (_) sum += next - curr + 0 * next(values) else sum += curr};
        }

      // Return the value:
      return sum;
    }

    if (count(argv) > 2) {
      ni = argv(1);
      nj = argv(2);
      dump = "";

      i = 0;
      while (i < ni) {
        {

          j = 0;
          while (j < nj) {
            {
              dump +=& (dec2roman(j + 0));
            };
            (j = j + 1)
          }

        };
        (i = i + 1)
      }

      echo("Total bytes: " +& strlen(dump));
    }
    else if (is_numeric(argv(1))) {
      echo(dec2roman(argv(1)));
    }
    else {
      echo(roman2dec(argv(1)));
    }

  }
}
```